<app-left>
  <div class="sider sider-menu">
    <task-menu style="overflow: hidden;" [dbNmae]="dbName" (menuChange)="onBridge($event)" #taskmenu></task-menu>
  </div>
  <div class="main" style="width: 100%;">
    <div *ngIf="data?.template" class="template">
      <div class="text">模板</div>
    </div>
    <nz-tabset class="task-tabset" (nzSelectChange)="changeTabs($event)">
      <nz-tab nzTitle="基础信息">
        <div class="form-edit">
          <form nz-form [formGroup]="formData" [hidden]="!formData">
            <div>
              <app-form-item [row]="true" label="模板" [hidden]="!edit">
                <nz-switch formControlName="template" nzCheckedChildren="是" nzUnCheckedChildren="否"></nz-switch>
              </app-form-item>
              <app-form-item label="梁号" [errors]="formData.get('name').errors">
                <input type="text" nz-input placeholder="请输入梁号" formControlName="name">
              </app-form-item>
              <app-form-item label="构建" [errors]="formData.get('component').errors">
                <nz-input-group class="tension-group" [nzAddOnAfter]="suffixButton">
                  <nz-select style="width: 100%;" nzPlaceHolder="请选择构建" formControlName="component">
                    <nz-option [nzValue]="item.value" [nzLabel]="item.label"
                      *ngFor="let item of componentMneu$ | async">
                    </nz-option>
                  </nz-select>
                </nz-input-group>
                <ng-template #suffixButton>
                  <button nz-button nzType="primary" (click)="manualGroup()" [disabled]="!(formData.get('component').value)">分组</button>
                </ng-template>
              </app-form-item>
              <app-form-item label="梁长度" [errors]="formData.get('beamLength').errors">
                <input type="number" nz-input placeholder="请输入梁长度" formControlName="beamLength">
              </app-form-item>
              <app-form-item label="浇筑日期" [errors]="formData.get('castingDate').errors">
                <nz-date-picker formControlName="castingDate" placeholder="浇筑日期"></nz-date-picker>
              </app-form-item>
              <app-form-item label="张拉日期" [errors]="formData.get('tensinDate').errors">
                <nz-date-picker formControlName="tensinDate" placeholder="张拉日期"></nz-date-picker>
              </app-form-item>

              <app-form-item label="施工员">
                <input type="text" nz-input placeholder="施工员" formControlName="operator">
              </app-form-item>
              <app-form-item label="监理员">
                <input type="text" nz-input placeholder="监理员" formControlName="supervisors">
              </app-form-item>
              <app-form-item label="自检员">
                <input type="text" nz-input placeholder="自检员" formControlName="qualityInspector">
              </app-form-item>
            </div>
            <div>
              <app-add-other [formGroup]="formData" [data]="data.otherInfo"></app-add-other>
            </div>
            <div>
              <tension-holes [data]="data" [formData]="formData" #holes></tension-holes>
            </div>
            <!-- <div>
              <mixing-info [formData]="formData" [data]="groutingTask"></mixing-info>
            </div>
            <div>
              <grouting-record [formData]="formData" [data]="groutingTask"></grouting-record>
            </div> -->
          </form>
          <!-- <div class="edit" [ngClass]="{'edit-on': appS.edit}" *ngIf="!appS.edit"></div> -->
        </div>

        <div class="operation" *ngIf="taskmenu?.project?.select">
          <app-operat [dbName]="dbName" [formData]="formData" (outEdit)="onEdit($event)" (outEditOk)="editOk($event)"
            (outDelete)="delete()" [addFilterFun]="addFilterFun" [updateFilterFun]="updateFilterFun" [coprState]="true">
            <button nz-button nzType="primary" (click)="upload()"
              [disabled]="!(data?.groutingInfo?.length > 0) || !uploading"><i nz-icon nzType="cloud-upload"
                nzTheme="outline"></i>上传</button>
            <button nz-button nzType="primary" (click)="test()" *ngIf="appS.platform === 'debug'">测试</button>
          </app-operat>
        </div>
      </nz-tab>
      <nz-tab nzTitle="其他">
        <p>创建者：{{data?.user}}</p>
        <p>创建日期：{{data?.createdDate | date: "yyyy.MM.dd HH:mm"}}</p>
        <p>修改日期：{{data?.modificationDate | date: "yyyy.MM.dd HH:mm"}}</p>
      </nz-tab>
    </nz-tabset>
  </div>
</app-left>
<app-delete-modal *ngIf="deleteShow" (outDelete)="deleteOk($event)"></app-delete-modal>
<tension-manual-group *ngIf="mamualGroupState" (outCancel)="manualGroupCancel()" (outOK)="manualGroupOk($event)"[holes]="nowComponentHoleInfo"></tension-manual-group>
