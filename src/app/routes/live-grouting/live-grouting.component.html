<div #container style="position: absolute; width: 100%;"></div>
<div class="content" >
  <header>
    <div class="state">
      {{GPLCS.linkMsg.state ? '设备链接' : '设备链接错误'}}
    </div>
    <div class="live">
      <h2>监控压浆：</h2>
      <nz-alert nzType="success" [nzMessage]="'梁号：' + now.name"></nz-alert>
      <nz-alert nzType="info" [nzMessage]="'孔号：' + now.holeName"></nz-alert>
      <nz-alert nzType="success" *ngIf="templateData" [nzMessage]="'模板：' + templateData.component + '/' + templateData.name"></nz-alert>
    </div>
    <div class="template">
      <button nz-button nzType="primary" (click)="groutingTemplateShow = true">{{templateData ? '更换模板' : '选择模板'}}</button>
    </div>
  </header>
  <main *ngIf="templateData">
    <!-- <div>
      {{templateData.groutingInfo[0].groups[0] | json}}
    </div> -->
    <div class="micing">
      <nz-divider style="min-width: auto;" nzText="搅拌监控" nzOrientation="center"></nz-divider>
      <table class="gridtable">
        <thead>
          <tr>
            <th></th>
            <th *ngFor="let item of templateData.proportionInfo.proportions" >{{item.name}}(kg)</th>
            <th>水胶比</th>
            <th>搅拌时间(s)</th>
            <th>水/环境温度(℃)</th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <tr>
              <td>设置配比</td>
              <td *ngFor="let item of templateData.proportionInfo.proportions">{{item.value}}</td>
              <td>{{templateData.proportionInfo.waterBinderRatio}}</td>
              <!-- <td><input type="number" nz-input placeholder="搅拌时间"></td> -->
              <td></td>
            </tr>
            <tr>
              <td>搅拌数据</td>
              <td *ngFor="let item of templateData.proportionInfo.proportions; index as i">{{mixingData?.dosage[i]}}</td>
              <td>{{mixingData?.waterBinderRatio}}</td>
              <td>{{mixingData?.mixingTime}}</td>
              <td>
                <div class="row">
                  水: {{mixingData?.waterTemperature}}
                </div>
                <div class="row">
                  环: {{mixingData?.envTemperature}}
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
    <div class="grouting">
      <nz-divider style="min-width: auto;" nzText="压浆监控" nzOrientation="center"></nz-divider>
      <table class="gridtable">
        <thead>
          <tr>
            <th>设置压力</th>
            <th>进浆压力</th>
            <th>回浆压力</th>
            <th>进浆量</th>
            <th>回浆量</th>
            <th>保压时间</th>
            <th>浆液/环境温度(℃)</th>
          </tr>
        </thead>
        <tbody>
          <ng-container>
            <tr>
              <td>{{ templateData.groutingInfo[0].groups[0].setGroutingPressure }}</td>
              <td>{{groutingHoleItem?.intoPulpPressure}}</td>
              <td>{{groutingHoleItem?.outPulpPressure}}</td>
              <td>{{groutingHoleItem?.intoPulpvolume}}</td>
              <td>{{groutingHoleItem?.outPulpvolume}}</td>
              <td>{{groutingHoleItem?.steadyTime}}</td>
              <td>
                <div class="row">
                  浆: {{groutingHoleItem?.slurryTemperature}}
                </div>
                <div class="row">
                  环: {{groutingHoleItem?.envTemperature}}
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
      <div>
        <br>
        <echarts-dynamic-line-grouting [width]="container.offsetWidth" [live]="groutingHoleItem?.processDatas?.date.length" [data]="groutingHoleItem?.processDatas?.date.length > 0 ? groutingHoleItem?.processDatas : null"></echarts-dynamic-line-grouting>
      </div>
    </div>
  </main>
</div>

<app-grouting-template *ngIf="groutingTemplateShow" (selectOut)="selectGroutingTemp($event)" (cancel)="groutingTemplateShow=false"></app-grouting-template>
